# Design

## 1. 项目概述

21310362 杨羔

本项目旨在设计一个基于 Java 命令行的个人所得税计算器，能够根据用户输入的工资薪金总额计算个人所得税，并支持以下功能：

- 计算个人所得税
- 设置个人所得税起征点
- 修改各级税率
- 显示当前税率表
- 退出程序

该程序使用 **面向对象编程（OOP）** 思想，设计清晰、扩展性强，以便未来维护和功能升级。

------

## 2. 功能需求

### 2.1 基本功能

- 根据用户输入的收入，计算应缴纳的个人所得税。
- 允许用户调整个人所得税起征点。
- 允许用户动态修改各级税率。
- 提供显示当前税率的功能。

------

## 3. 类设计

### 3.1 类图（UML）

```pgsql
+-----------------------+
|   IncomeTaxCalculator  |
+-----------------------+
| - taxThreshold: double |
| - TAX_BRACKETS: double[][]
+-----------------------+
| + main(String[]): void |
| + calculateTax(Scanner): void |
| + setTaxThreshold(Scanner): void |
| + setTaxRates(Scanner): void |
| + displayTaxRates(): void |
+-----------------------+
```

------

### 3.2 类说明

#### `IncomeTaxCalculator` 类

**功能：**

- 提供个人所得税计算的核心逻辑。
- 提供税率、起征点的修改及展示功能。

**属性（成员变量）：**

| 成员变量       | 类型         | 说明                   |
| -------------- | ------------ | ---------------------- |
| `taxThreshold` | `double`     | 个人所得税起征点       |
| `TAX_BRACKETS` | `double[][]` | 税率及其对应的收入区间 |

**方法（成员方法）：**

| 方法名                     | 返回类型 | 说明                     |
| -------------------------- | -------- | ------------------------ |
| `main(String[] args)`      | `void`   | 程序入口，控制主菜单逻辑 |
| `calculateTax(Scanner)`    | `void`   | 计算个人所得税并显示结果 |
| `setTaxThreshold(Scanner)` | `void`   | 设置新的个人所得税起征点 |
| `setTaxRates(Scanner)`     | `void`   | 修改各级税率             |
| `displayTaxRates()`        | `void`   | 显示当前税率表           |

------

## 4. 流程图

```lua
+--------------------------------------+
|             程序启动                  |
+--------------------------------------+
                |
                v
+--------------------------------------+
|         显示主菜单，提示用户输入       |
+--------------------------------------+
                |
                v
+------------(用户选择)----------------+
| 1. 计算个人所得税                    |
| 2. 设置起征点                        |
| 3. 修改税率                          |
| 4. 显示当前税率                      |
| 5. 退出程序                          |
+--------------------------------------+
                |
                v
        +---------------+
        |    根据选择跳转  |
        +---------------+
```

------

## 5. 异常处理

| 异常触发场景                   | 解决方案                                |
| ------------------------------ | --------------------------------------- |
| 用户输入非数字时               | 提示用户重新输入并清空 `Scanner` 缓冲区 |
| 数据输入流意外终止或文件为空时 | 提示输入文件可能有误，建议检查          |
| 用户输入负数工资或非法税率值   | 明确提示工资和税率不能为负数            |
| 修改税率时输入级别超出范围     | 提示税率级别不在有效范围内              |

------

## 6. 运行bat文件

![image-20250319220818605](../../AppData/Roaming/Typora/typora-user-images/image-20250319220818605.png)

### 6.1 用户交互

点击run_user.bat

### 6.2 样例测试

点击run_test.bat

共有四个测试用例：

| 测试样例  |             作用             |
| :-------: | :--------------------------: |
| case1.txt |    测试计算个人所得稅功能    |
| case2.txt | 测试设置起征点功能和稅率功能 |
| case3.txt |  测试个人所得稅和起的健壮性  |
| case4.txt |    测试设置税率功能健壮性    |

